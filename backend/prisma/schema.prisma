generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model struktur_files {
  id         Int      @id @default(autoincrement())
  nama_file  String
  file_path  String
  created_at DateTime @default(now()) @db.Timestamp(6)
}

model budaya_mutu {
  id         Int      @id @default(autoincrement())
  type       String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model relevansi_pendidikan {
  id                     Int       @id @default(autoincrement())
  type                   String    @db.VarChar(100)
  tahun                  String?   @db.VarChar(10)
  ts2                    String?   @db.VarChar(100)
  ts1                    String?   @db.VarChar(100)
  ts                     String?   @db.VarChar(100)
  linkbukti              String?
  daya_tampung           Int?
  pendaftar              Int?
  diterima               Int?
  aktif                  Int?
  asalmahasiswa          String?   @db.VarChar(255)
  alasan                 String?
  jumlah                 Int?
  mata_kuliah            String?   @db.VarChar(255)
  sks                    Int?
  semester               String?   @db.VarChar(20)
  profil_lulusan         String?
  pl1                    String?
  pl2                    String?
  cpl                    String?
  cpmk                   String?
  semester1              String?
  semester2              String?
  semester3              String?
  semester4              String?
  semester5              String?
  semester6              String?
  semester7              String?
  semester8              String?
  jumlah_lulusan         Int?
  jumlah_terlacak        Int?
  rata_rata_waktu_tunggu Decimal?  @db.Decimal(5, 2)
  profesi_infokom        String?
  profesi_noninfokom     String?
  lingkup_internasional  String?
  lingkup_nasional       String?
  lingkup_wirausaha      String?
  no                     Int?
  jenis_kemampuan        String?
  sangat_baik            Int?
  baik                   Int?
  cukup                  Int?
  kurang                 Int?
  rencana_tindak_lanjut  String?
  tahun_akademik         String?   @db.VarChar(20)
  sumber_rekognisi       String?
  jenis_pengakuan        String?
  created_at             DateTime? @default(now()) @db.Timestamp(6)
  updated_at             DateTime? @default(now()) @db.Timestamp(6)
}

model relevansi_penelitian {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String   @db.VarChar(100)
  data       Json // semua data FE masuk ke sini
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_penelitian_subtab")
  @@index([user_id], map: "idx_relevansi_penelitian_user")
}

model relevansi_pkm {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String   @db.VarChar(100)
  data       Json // semua data FE masuk ke sini
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_pkm_subtab")
  @@index([user_id], map: "idx_relevansi_pkm_user")
}

model diferensiasi_misi {
  id         Int      @id @default(autoincrement())
  tipe_data  String?
  unit_kerja String?
  konten     String?
  type       String?  @db.VarChar(50)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

// =========================
// USERS (AUTH)
// =========================
//
model users {
  id         Int       @id @default(autoincrement())
  username   String    @unique @db.VarChar(50)
  email      String    @unique @db.VarChar(100)
  password   String    @db.VarChar(255)
  role       String?   @default("user") @db.VarChar(20)
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relasi balik
  relevansi_penelitian relevansi_penelitian[]
  relevansi_pkm        relevansi_pkm[]
}

// =========================
// LED (Laporan Evaluasi Diri)
// =========================
model led {
  id         Int      @id @default(autoincrement())
  tabs       Json
  created_at DateTime @default(now()) @db.Timestamp(6)
  updated_at DateTime @updatedAt @db.Timestamp(6)

  @@map("led")
}
