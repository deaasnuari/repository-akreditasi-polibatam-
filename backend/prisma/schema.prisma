generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model struktur_files {
  id         Int      @id @default(autoincrement())
  nama_file  String
  file_path  String
  created_at DateTime @default(now()) @db.Timestamp(6)
}

model budaya_mutu {
  id         Int      @id @default(autoincrement())
  type       String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model relevansi_pendidikan {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String   @db.VarChar(100)
  data       Json // semua data FE masuk ke sini
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_pendidikan_subtab")
  @@index([user_id], map: "idx_relevansi_pendidikan_user")
}

model relevansi_penelitian {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String   @db.VarChar(100)
  data       Json // semua data FE masuk ke sini
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_penelitian_subtab")
  @@index([user_id], map: "idx_relevansi_penelitian_user")
}

model relevansi_pkm {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String   @db.VarChar(100)
  data       Json // semua data FE masuk ke sini
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_pkm_subtab")
  @@index([user_id], map: "idx_relevansi_pkm_user")
}

model akuntabilitas {
  id         Int      @id @default(autoincrement())
  type       String   @db.VarChar(100)
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("akuntabilitas")
}

model diferensiasi_misi {
  id         Int      @id @default(autoincrement())
  tipe_data  String?
  unit_kerja String?
  konten     String?
  type       String?  @db.VarChar(50)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

// =========================
// USERS (AUTH)
// =========================
//
model users {
  id         Int       @id @default(autoincrement())
  username   String    @unique @db.VarChar(50)
  email      String    @unique @db.VarChar(100)
  password   String    @db.VarChar(255)
  role       String?   @default("user") @db.VarChar(20)
  created_at DateTime? @default(now()) @db.Timestamp(6)

  // Relasi balik
  relevansi_penelitian relevansi_penelitian[]
  relevansi_pkm        relevansi_pkm[]
  relevansi_pendidikan relevansi_pendidikan[]
}

// =========================
// LED (Laporan Evaluasi Diri)
// =========================
model led {
  id         Int      @id @default(autoincrement())
  tabs       Json
  created_at DateTime @default(now()) @db.Timestamp(6)
  updated_at DateTime @updatedAt @db.Timestamp(6)

  @@map("led")
}
