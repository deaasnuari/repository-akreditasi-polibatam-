datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model struktur_files {
  id         Int      @id @default(autoincrement())
  nama_file  String
  file_path  String
  created_at DateTime @default(now())
}

model budaya_mutu {
  id         Int      @id @default(autoincrement())
  user_id    Int
  type       String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([user_id], map: "idx_budaya_mutu_user")
}

model relevansi_pendidikan {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_pendidikan_subtab")
  @@index([user_id], map: "idx_relevansi_pendidikan_user")
}

model relevansi_penelitian {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_penelitian_subtab")
  @@index([user_id], map: "idx_relevansi_penelitian_user")
}

model relevansi_pkm {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @default(now()) @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_relevansi_pkm_subtab")
  @@index([user_id], map: "idx_relevansi_pkm_user")
}

model akuntabilitas {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_akuntabilitas_subtab")
  @@index([user_id], map: "idx_akuntabilitas_user")

  @@map("akuntabilitas")
}

model diferensiasi_misi {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@index([subtab], map: "idx_diferensiasi_misi_subtab")
  @@index([user_id], map: "idx_diferensiasi_misi_user")
}

// USERS AUTH
model users {
  id               Int       @id @default(autoincrement())
  username         String    @unique
  email            String    @unique
  password         String
  nama_lengkap     String?
  role             String    @default("TU")
  status           String    @default("aktif")
  created_at       DateTime  @default(now())
  updated_at       DateTime  @default(now()) @updatedAt

  relevansi_penelitian relevansi_penelitian[]
  relevansi_pkm        relevansi_pkm[]
  relevansi_pendidikan relevansi_pendidikan[]
  akuntabilitas        akuntabilitas[]
  diferensiasi_misi    diferensiasi_misi[]
  budaya_mutu          budaya_mutu[]
  led                  led[]
}

// LED
model led {
  id         Int      @id @default(autoincrement())
  user_id    Int
  subtab     String
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user users @relation(fields: [user_id], references: [id])

  @@unique([user_id, subtab], map: "user_id_subtab")
  @@index([subtab], map: "idx_led_subtab")
  @@index([user_id], map: "idx_led_user")

  @@map("led")
}
